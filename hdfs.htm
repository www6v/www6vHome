<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=Generator content="Microsoft Word 12 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:"Times New Roman","serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"页眉 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	layout-grid-mode:char;
	border:none;
	padding:0cm;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"页脚 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
span.Char
	{mso-style-name:"页眉 Char";
	mso-style-link:页眉;}
span.Char0
	{mso-style-name:"页脚 Char";
	mso-style-link:页脚;}
.MsoChpDefault
	{font-size:10.5pt;}
 /* Page Definitions */
 @page Section1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=ZH-CN link=blue vlink=purple style='text-justify-trim:punctuation'>

<div class=Section1>

<p class=MsoNormal style='text-autospace:none'><span style='font-family:宋体'>　</span><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span lang=EN-US style='font-size:16.0pt'>&nbsp;HDFS NameNode HA </span><span
style='font-size:16.0pt;font-family:宋体'>简述</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US>&nbsp; </span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;
</span><span lang=EN-US style='font-size:12.0pt'>HDFS NameNode</span><span
style='font-size:12.0pt;font-family:宋体'>是可靠和高效的</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>简单的架构使</span><span lang=EN-US style='font-size:12.0pt'>HDFS</span><span
style='font-size:12.0pt;font-family:宋体'>能够在上千个节点可靠的存放生产级的数据</span><span
lang=EN-US style='font-size:12.0pt'>. </span><span style='font-size:12.0pt;
font-family:宋体'>但是</span><span lang=EN-US style='font-size:12.0pt'>, HDFS
NameNode</span><span style='font-size:12.0pt;font-family:宋体'>也是一个集群中的单点</span><span
lang=EN-US style='font-size:12.0pt'>(SPOF). </span><span style='font-size:12.0pt;
font-family:宋体'>开源社区也提供了几个</span><span lang=EN-US style='font-size:12.0pt'>HA</span><span
style='font-size:12.0pt;font-family:宋体'>的解决方案</span><span lang=EN-US
style='font-size:12.0pt'>.</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp; </span></p>

<p class=MsoNormal style='text-indent:18.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt'>HDFS Namenode </span><span
style='font-size:12.0pt;font-family:宋体'>宕机后启动时构建状态的两个相对长的阶段包括</span><span
lang=EN-US style='font-size:12.0pt'>:</span><span style='font-size:12.0pt;
font-family:宋体'>　</span><span lang=EN-US style='font-size:12.0pt'> I. </span><span
style='font-size:12.0pt;font-family:宋体'>加载</span><span lang=EN-US
style='font-size:12.0pt'>fsimage,</span><span style='font-size:12.0pt;
font-family:宋体'>并回放</span><span lang=EN-US style='font-size:12.0pt'>editlog.&nbsp;&nbsp;&nbsp;
II. datanode</span><span style='font-size:12.0pt;font-family:宋体'>块的汇报</span><span
lang=EN-US style='font-size:12.0pt'>, blockMap</span><span style='font-size:
12.0pt;font-family:宋体'>的构建</span><span lang=EN-US style='font-size:12.0pt'>.
HDFS Namenode HA</span><span style='font-size:12.0pt;font-family:宋体'>主要是指</span><span
lang=EN-US style='font-size:12.0pt'>Ediglog</span><span style='font-size:12.0pt;
font-family:宋体'>的</span><span lang=EN-US style='font-size:12.0pt'>HA,&nbsp; </span><span
style='font-size:12.0pt;font-family:宋体'>不包括</span><span lang=EN-US
style='font-size:12.0pt'>FSImage</span></p>

<p class=MsoNormal style='text-indent:15.75pt;text-autospace:none'><span
lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='color:red'>&nbsp;&nbsp; </span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='color:red'>&nbsp;&nbsp; </span></p>

<p class=MsoNormal style='margin-left:0cm;text-indent:0cm;text-autospace:none'><b><span
lang=EN-US style='font-size:15.0pt'>1)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span></b><b><span lang=EN-US style='font-size:15.0pt'>HDFS&nbsp; HA </span></b><b><span
style='font-size:15.0pt;font-family:宋体'>解决方案</span></b></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:11.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><b><span lang=EN-US
style='font-size:12.0pt'>Secondary NameNode(SNN)</span></b></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:12.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt'>Secondary NameNode </span><span
style='font-size:12.0pt;font-family:宋体'>周期的合并</span><span lang=EN-US
style='font-size:12.0pt'>edits</span><span style='font-size:12.0pt;font-family:
宋体'>和</span><span lang=EN-US style='font-size:12.0pt'>fsimage</span><span
style='font-size:12.0pt;font-family:宋体'>，能减少集群重启的时间。</span><span lang=EN-US
style='font-size:12.0pt'>SNN</span><span style='font-size:12.0pt;font-family:
宋体'>会周期的做检查点</span><span lang=EN-US style='font-size:12.0pt'>(</span><span
style='font-size:12.0pt;font-family:宋体'>默认一个小时</span><span lang=EN-US
style='font-size:12.0pt'>). </span><span style='font-size:12.0pt;font-family:
宋体'>如果ＮＮ宕机</span><span lang=EN-US style='font-size:12.0pt'>, </span><span
style='font-size:12.0pt;font-family:宋体'>宕机前和上一次</span><span lang=EN-US
style='font-size:12.0pt'>checkpoint</span><span style='font-size:12.0pt;
font-family:宋体'>这个时间段的状态变更会丢失</span><span lang=EN-US style='font-size:12.0pt'>,
</span><span style='font-size:12.0pt;font-family:宋体'>所以元数据并不是最新</span><span
lang=EN-US style='font-size:12.0pt'>.</span><span style='font-size:12.0pt;
font-family:宋体'>　</span><span lang=EN-US style='font-size:12.0pt'> </span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:12.0pt;text-autospace:none'><span
style='font-size:12.0pt;font-family:宋体'>当</span><span lang=EN-US
style='font-size:12.0pt'>NameNode(NN)</span><span style='font-size:12.0pt;
font-family:宋体'>失效的时</span><span style='font-size:12.0pt'> </span><span
style='font-size:12.0pt;font-family:宋体'>候，</span><span lang=EN-US
style='font-size:12.0pt'>Secondary NN</span><span style='font-size:12.0pt;
font-family:宋体'>并无法立刻提供服务</span><span lang=EN-US style='font-size:12.0pt'>.</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><b><span lang=EN-US
style='font-size:12.0pt'>BackupNode(BN): </span></b></p>

<p class=MsoNormal style='text-autospace:none'><b><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></b></p>

<p class=MsoNormal style='text-indent:18.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt'>BackupNode</span><span style='font-size:
12.0pt;font-family:宋体'>是社区版</span><span lang=EN-US style='font-size:12.0pt'>Hadoop
0.21</span><span style='font-size:12.0pt;font-family:宋体'>提供的一种高可用方案。它不仅实现了</span><span
lang=EN-US style='font-size:12.0pt'>SecondaryNameNode</span><span
style='font-size:12.0pt;font-family:宋体'>的功能，还实现了复写功能，即同时向</span><span
lang=EN-US style='font-size:12.0pt'>Active Namenode</span><span
style='font-size:12.0pt;font-family:宋体'>和</span><span lang=EN-US
style='font-size:12.0pt'>Standby Namenode</span><span style='font-size:12.0pt;
font-family:宋体'>写入</span><span lang=EN-US style='font-size:12.0pt'>EditLog</span><span
style='font-size:12.0pt;font-family:宋体'>，这样也避免了共享存储会遇到的</span><span lang=EN-US
style='font-size:12.0pt'>“IO Fencing”</span><span style='font-size:12.0pt;
font-family:宋体'>问题。</span><span lang=EN-US style='font-size:12.0pt'> SNN&nbsp; </span><span
style='font-size:12.0pt;font-family:宋体'>是每隔一段时间去</span><span lang=EN-US
style='font-size:12.0pt'>&nbsp; NN&nbsp; </span><span style='font-size:12.0pt;
font-family:宋体'>下载</span><span lang=EN-US style='font-size:12.0pt'>&nbsp;
fsimage&nbsp; </span><span style='font-size:12.0pt;font-family:宋体'>和</span><span
style='font-size:12.0pt'> <span lang=EN-US>&nbsp;edits&nbsp; </span></span><span
style='font-size:12.0pt;font-family:宋体'>文件，而</span><span lang=EN-US
style='font-size:12.0pt'>NN&nbsp; </span><span style='font-size:12.0pt;
font-family:宋体'>可以实时的将日志传送给</span><span lang=EN-US style='font-size:12.0pt'>&nbsp;
BN </span><span style='font-size:12.0pt;font-family:宋体'>，然后将操作合并到</span><span
lang=EN-US style='font-size:12.0pt'>&nbsp; fsimage&nbsp; </span><span
style='font-size:12.0pt;font-family:宋体'>里。</span></p>

<p class=MsoNormal style='text-indent:18.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:18.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:宋体'><img width=463 height=198
src="hdfs.files/image001.jpg"></span></p>

<p class=MsoNormal style='text-indent:18.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:18.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt;font-family:"Cambria","serif"'>BackupNode </span><span
style='font-size:12.0pt;font-family:宋体'>很便宜</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>, </span><span
style='font-size:12.0pt;font-family:宋体'>简易</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>, </span><span
style='font-size:12.0pt;font-family:宋体'>也考虑到了以下的用例</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>: </span><span
style='font-size:12.0pt;font-family:宋体'>主节点在运行</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>, Standby </span><span
style='font-size:12.0pt;font-family:宋体'>在线下维护</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>. </span><span
style='font-size:12.0pt;font-family:宋体'>主节点宕机并且不能重启</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>.&nbsp; Standby</span><span
style='font-size:12.0pt;font-family:宋体'>需要启动并接管主节点</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>.&nbsp; </span><span
lang=EN-US style='font-size:12.0pt;font-family:宋体'>&nbsp;</span><span
style='font-size:12.0pt;font-family:宋体'>如果</span><span lang=EN-US
style='font-size:12.0pt'>Standby</span><span style='font-size:12.0pt;
font-family:宋体'>不可用，</span><span lang=EN-US style='font-size:12.0pt'>Active
Namenode</span><span style='font-size:12.0pt;font-family:宋体'>会把</span><span
lang=EN-US style='font-size:12.0pt'>EditLog</span><span style='font-size:12.0pt;
font-family:宋体'>备份到其他的地方。</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:18.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt'>BackupNode</span><span style='font-size:
12.0pt;font-family:宋体'>只能算主从温备，因为</span><span lang=EN-US style='font-size:12.0pt'>Datanode</span><span
style='font-size:12.0pt;font-family:宋体'>只会向</span><span lang=EN-US
style='font-size:12.0pt'>Active Namenode</span><span style='font-size:12.0pt;
font-family:宋体'>汇报和保持心跳，一旦</span><span lang=EN-US style='font-size:12.0pt'>Active
Namenode</span><span style='font-size:12.0pt;font-family:宋体'>发生故障，需要人工切换到</span><span
lang=EN-US style='font-size:12.0pt'>BackupNode</span><span style='font-size:
12.0pt;font-family:宋体'>上，并且需要在</span><span lang=EN-US style='font-size:12.0pt'>BackupNode</span><span
style='font-size:12.0pt;font-family:宋体'>上把</span><span lang=EN-US
style='font-size:12.0pt'>BlocksMap</span><span style='font-size:12.0pt;
font-family:宋体'>状态完全构建起来，这样的切换</span><span style='font-size:12.0pt'> </span><span
style='font-size:12.0pt;font-family:宋体'>时间在分钟</span><span lang=EN-US
style='font-size:12.0pt'>~</span><span style='font-size:12.0pt;font-family:
宋体'>小时级别。</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><b><span lang=EN-US
style='font-size:12.0pt'>AvatarNode:</span></b></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;&nbsp;&nbsp; Facebook</span><span
style='font-size:12.0pt;font-family:宋体'>的</span><span lang=EN-US
style='font-size:12.0pt'>AvatarNode</span><span style='font-size:12.0pt;
font-family:宋体'>是业界较早的</span><span lang=EN-US style='font-size:12.0pt'>Namenode
HA</span><span style='font-size:12.0pt;font-family:宋体'>方案，它是基于</span><span
lang=EN-US style='font-size:12.0pt'>HDFS 0.20</span><span style='font-size:
12.0pt;font-family:宋体'>实现的，如下图所示。由于采用的是人工切换，所以实现相对简单。</span><span lang=EN-US
style='font-size:12.0pt'>AvatarNode</span><span style='font-size:12.0pt;
font-family:宋体'>对</span><span lang=EN-US style='font-size:12.0pt'>Namenode</span><span
style='font-size:12.0pt;font-family:宋体'>进行了封装，处于工作状态的叫</span><span lang=EN-US
style='font-size:12.0pt'> Primary Avatar</span><span style='font-size:12.0pt;
font-family:宋体'>，处于热备状态的叫</span><span lang=EN-US style='font-size:12.0pt'>Standby
Avatar(</span><span style='font-size:12.0pt;font-family:宋体'>封装了</span><span
lang=EN-US style='font-size:12.0pt'>Namenode</span><span style='font-size:12.0pt;
font-family:宋体'>和</span><span lang=EN-US style='font-size:12.0pt'>SecondaryNameNode)</span><span
style='font-size:12.0pt;font-family:宋体'>，两者通过</span><span lang=EN-US
style='font-size:12.0pt'>NFS</span><span style='font-size:12.0pt;font-family:
宋体'>共享</span><span lang=EN-US style='font-size:12.0pt'>EditLog</span><span
style='font-size:12.0pt;font-family:宋体'>所在目录。在工作状态</span><span
style='font-size:12.0pt'> </span><span style='font-size:12.0pt;font-family:
宋体'>下，</span><span lang=EN-US style='font-size:12.0pt'>Primary Avatar</span><span
style='font-size:12.0pt;font-family:宋体'>中的</span><span lang=EN-US
style='font-size:12.0pt'>Namenode</span><span style='font-size:12.0pt;
font-family:宋体'>实例接收</span><span lang=EN-US style='font-size:12.0pt'>Client</span><span
style='font-size:12.0pt;font-family:宋体'>的请求并进行处理，</span><span lang=EN-US
style='font-size:12.0pt'>Datanode</span><span style='font-size:12.0pt;
font-family:宋体'>会向</span><span lang=EN-US style='font-size:12.0pt'>Primary</span><span
style='font-size:12.0pt;font-family:宋体'>和</span><span lang=EN-US
style='font-size:12.0pt'>Standby</span><span style='font-size:12.0pt;
font-family:宋体'>两个同时发送</span><span lang=EN-US style='font-size:12.0pt'>
blockReport</span><span style='font-size:12.0pt;font-family:宋体'>和心跳，</span><span
lang=EN-US style='font-size:12.0pt'>Standby Avatar</span><span
style='font-size:12.0pt;font-family:宋体'>不断地从共享的</span><span lang=EN-US
style='font-size:12.0pt'>EditLog</span><span style='font-size:12.0pt;
font-family:宋体'>中持续写入的新事务，并推送给它的</span><span lang=EN-US style='font-size:12.0pt'>Namenode</span><span
style='font-size:12.0pt;font-family:宋体'>实例，此时</span><span lang=EN-US
style='font-size:12.0pt'>Standby Avatar</span><span style='font-size:12.0pt;
font-family:宋体'>内部的</span><span lang=EN-US style='font-size:12.0pt'>Namenode</span><span
style='font-size:12.0pt;font-family:宋体'>处于安全模式状态，不对外提供服务，但是状态与</span><span
lang=EN-US style='font-size:12.0pt'>Primary Avatar</span><span
style='font-size:12.0pt;font-family:宋体'>中的保持一致。一旦</span><span lang=EN-US
style='font-size:12.0pt'>Primary</span><span style='font-size:12.0pt;
font-family:宋体'>发生故障，管理员进行</span><span lang=EN-US style='font-size:12.0pt'>Failover</span><span
style='font-size:12.0pt;font-family:宋体'>切换：首先将原来的</span><span lang=EN-US
style='font-size:12.0pt'>Primary</span><span style='font-size:12.0pt;
font-family:宋体'>进程杀死</span><span lang=EN-US style='font-size:12.0pt'>(</span><span
style='font-size:12.0pt;font-family:宋体'>避免了</span><span lang=EN-US
style='font-size:12.0pt'>“Split Brain”</span><span style='font-size:12.0pt;
font-family:宋体'>和</span><span lang=EN-US style='font-size:12.0pt'>“IO Fencing”</span><span
style='font-size:12.0pt;font-family:宋体'>问题</span><span lang=EN-US
style='font-size:12.0pt'>)</span><span style='font-size:12.0pt;font-family:
宋体'>，然后将原来的</span><span lang=EN-US style='font-size:12.0pt'>Standby</span><span
style='font-size:12.0pt;font-family:宋体'>设置为</span><span lang=EN-US
style='font-size:12.0pt'>Primary</span><span style='font-size:12.0pt;
font-family:宋体'>，新的</span><span lang=EN-US style='font-size:12.0pt'>Primary</span><span
style='font-size:12.0pt;font-family:宋体'>会保证回放完成所有的</span><span lang=EN-US
style='font-size:12.0pt'>EditLog</span><span style='font-size:12.0pt;
font-family:宋体'>事务，然后退出安全模</span><span style='font-size:12.0pt'> </span><span
style='font-size:12.0pt;font-family:宋体'>式，对外接收服务请求。为了实现对客户端透明，</span><span
lang=EN-US style='font-size:12.0pt'>AvatarNode</span><span style='font-size:
12.0pt;font-family:宋体'>主从采用相同的虚拟</span><span lang=EN-US style='font-size:12.0pt'>IP</span><span
style='font-size:12.0pt;font-family:宋体'>，切换时将新的</span><span lang=EN-US
style='font-size:12.0pt'>Primary</span><span style='font-size:12.0pt;
font-family:宋体'>设置为该虚拟</span><span lang=EN-US style='font-size:12.0pt'>IP</span><span
style='font-size:12.0pt;font-family:宋体'>即可。整个流程</span><span style='font-size:
12.0pt'> </span><span style='font-size:12.0pt;font-family:宋体'>可在秒</span><span
lang=EN-US style='font-size:12.0pt'>~</span><span style='font-size:12.0pt;
font-family:宋体'>分钟级别完成。</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:宋体'><img width=322 height=307 src="hdfs.files/image002.jpg"></span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:宋体'><img width=355 height=263 src="hdfs.files/image003.jpg"></span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><b><span lang=EN-US
style='font-size:12.0pt'>Hadoop 2.0&nbsp; HA</span></b></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;&nbsp;&nbsp; Hadoop 2.0 HA </span><span
style='font-size:12.0pt;font-family:宋体'>在很多地方借鉴了</span><span lang=EN-US
style='font-size:12.0pt'> AvatarNode:</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
font-family:宋体'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:宋体'><img width=553 height=350 src="hdfs.files/image004.jpg"></span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt'>&nbsp;I. </span><span style='font-size:
12.0pt;font-family:宋体'>同步</span><span lang=EN-US style='font-size:12.0pt'>edits</span><span
style='font-size:12.0pt;font-family:宋体'>信息</span></p>

<p class=MsoNormal style='text-indent:24.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt'>&nbsp;NN active</span><span
style='font-size:12.0pt;font-family:宋体'>和</span><span lang=EN-US
style='font-size:12.0pt'>NN standby</span><span style='font-size:12.0pt;
font-family:宋体'>之间共享存储</span><span lang=EN-US style='font-size:12.0pt'>(share
storage) edits</span><span style='font-size:12.0pt;font-family:宋体'>信息</span><span
lang=EN-US style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;
font-family:宋体'>通常用</span><span lang=EN-US style='font-size:12.0pt'>NFS. </span><span
style='font-size:12.0pt;font-family:宋体'>这相当于单点故障的位置转移到了中高端的存储设备内部</span><span
lang=EN-US style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;
font-family:宋体'>依赖外部存储的可靠性</span><span lang=EN-US style='font-size:12.0pt'>.&nbsp;
NN</span><span style='font-size:12.0pt;font-family:宋体'>内部每次元数据变动后的</span><span
lang=EN-US style='font-size:12.0pt'>flush</span><span style='font-size:12.0pt;
font-family:宋体'>操作，加上</span><span lang=EN-US style='font-size:12.0pt'>NFS</span><span
style='font-size:12.0pt;font-family:宋体'>的</span><span lang=EN-US
style='font-size:12.0pt'>close-to-open</span><span style='font-size:12.0pt;
font-family:宋体'>，数据的一致性得到了保证。在使用了</span><span lang=EN-US style='font-size:12.0pt'>NFS</span><span
style='font-size:12.0pt;font-family:宋体'>做</span><span lang=EN-US
style='font-size:12.0pt'>editLog</span><span style='font-size:12.0pt;
font-family:宋体'>的</span><span lang=EN-US style='font-size:12.0pt'>standby</span><span
style='font-size:12.0pt;font-family:宋体'>这个阶段后</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>社区下个阶段更推崇使用</span><span lang=EN-US style='font-size:12.0pt'>BookKeeper</span><span
style='font-size:12.0pt;font-family:宋体'>做</span><span lang=EN-US
style='font-size:12.0pt'>EditLog</span><span style='font-size:12.0pt;
font-family:宋体'>的存储</span><span lang=EN-US style='font-size:12.0pt'>. </span><span
style='font-size:12.0pt;font-family:宋体'>并且这些功能是实现为可插拔的</span><span lang=EN-US
style='font-size:12.0pt'>.</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:12.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt'>&nbsp;&nbsp; II. FailoverController</span><span
style='font-size:12.0pt;font-family:宋体'>作为</span><span lang=EN-US
style='font-size:12.0pt'>NN</span><span style='font-size:12.0pt;font-family:
宋体'>进程的</span><span lang=EN-US style='font-size:12.0pt'>WatchDog</span></p>

<p class=MsoNormal style='text-indent:12.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt'>&nbsp;&nbsp; FailoverController</span><span
style='font-size:12.0pt;font-family:宋体'>是一种协调器</span><span lang=EN-US
style='font-size:12.0pt'>(coordination), </span><span style='font-size:12.0pt;
font-family:宋体'>作为</span><span lang=EN-US style='font-size:12.0pt'>ZooKeeper</span><span
style='font-size:12.0pt;font-family:宋体'>的客户端</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>主要的指责是领导者选举</span><span lang=EN-US style='font-size:12.0pt'>(leader
election),&nbsp; </span><span style='font-size:12.0pt;font-family:宋体'>在</span><span
lang=EN-US style='font-size:12.0pt'>NN</span><span style='font-size:12.0pt;
font-family:宋体'>宕机之后</span><span lang=EN-US style='font-size:12.0pt'>, </span><span
style='font-size:12.0pt;font-family:宋体'>自动化的选举出领导者</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>并透明的切换到</span><span lang=EN-US style='font-size:12.0pt'>standby</span><span
style='font-size:12.0pt;font-family:宋体'>上</span><span lang=EN-US
style='font-size:12.0pt'>.</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-size:12.0pt;font-family:宋体'>错误检测机制通过</span><span lang=EN-US
style='font-size:12.0pt'>ZK</span><span style='font-size:12.0pt;font-family:
宋体'>的临时节点</span><span lang=EN-US style='font-size:12.0pt'>(ephemeral nodes)</span><span
style='font-size:12.0pt;font-family:宋体'>来实现的</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>用心跳和现在的系统集成在一起</span><span lang=EN-US style='font-size:12.0pt'>. </span><span
style='font-size:12.0pt;font-family:宋体'>在</span><span lang=EN-US
style='font-size:12.0pt'>NN full gc</span><span style='font-size:12.0pt;
font-family:宋体'>时</span><span lang=EN-US style='font-size:12.0pt'>, </span><span
style='font-size:12.0pt;font-family:宋体'>会</span><span lang=EN-US
style='font-size:12.0pt'>stop the world, </span><span style='font-size:12.0pt;
font-family:宋体'>对这类</span><span lang=EN-US style='font-size:12.0pt'>GC</span><span
style='font-size:12.0pt;font-family:宋体'>有特殊的管理</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>防止误认为</span><span lang=EN-US style='font-size:12.0pt'>NN active</span><span
style='font-size:12.0pt;font-family:宋体'>已宕机</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>剥离出来的</span><span lang=EN-US style='font-size:12.0pt'>FailoverController</span><span
style='font-size:12.0pt;font-family:宋体'>能解决这个问题</span><span lang=EN-US
style='font-size:12.0pt'>. </span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp; </span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>III. fail-over</span><span style='font-size:12.0pt;
font-family:宋体'>选择</span></p>

<p class=MsoNormal style='text-indent:30.0pt;text-autospace:none'><span
style='font-size:12.0pt;font-family:宋体'>用户想要对</span><span lang=EN-US
style='font-size:12.0pt'>fail-over</span><span style='font-size:12.0pt;
font-family:宋体'>做手工或者自动的热备份</span><span lang=EN-US style='font-size:12.0pt'>,
Hadoop 2.0&nbsp; HA</span><span style='font-size:12.0pt;font-family:宋体'>提供了这两种选择</span><span
lang=EN-US style='font-size:12.0pt'>.</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>IV. DN block reports</span></p>

<p class=MsoNormal style='text-indent:30.0pt;text-autospace:none'><span
style='font-size:12.0pt;font-family:宋体'>向</span><span lang=EN-US
style='font-size:12.0pt'>standby</span><span style='font-size:12.0pt;
font-family:宋体'>回报块</span><span lang=EN-US style='font-size:12.0pt'>(block
reports)</span><span style='font-size:12.0pt;font-family:宋体'>的逻辑重用了</span><span
lang=EN-US style='font-size:12.0pt'>AvatarNode</span><span style='font-size:
12.0pt;font-family:宋体'>部分的代码</span><span lang=EN-US style='font-size:12.0pt'>.</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><b><span lang=EN-US
style='font-size:12.0pt'>Quorum Journal Manager /Paxos HA</span></b></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:18.0pt;text-autospace:none'><span
style='font-size:12.0pt;font-family:宋体'>目前采用最多的就是用共享存储</span><span lang=EN-US
style='font-size:12.0pt'>NAS+NFS, </span><span style='font-size:12.0pt;
font-family:宋体'>但这些存储设备要求是</span><span lang=EN-US style='font-size:12.0pt'>HA</span><span
style='font-size:12.0pt;font-family:宋体'>的</span><span lang=EN-US
style='font-size:12.0pt'>. </span><span style='font-size:12.0pt;font-family:
宋体'>可以使用</span><span lang=EN-US style='font-size:12.0pt'>RAID</span><span
style='font-size:12.0pt;font-family:宋体'>技术</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>利用磁盘阵列的手段</span><span lang=EN-US style='font-size:12.0pt'>,&nbsp; </span><span
style='font-size:12.0pt;font-family:宋体'>提升数据的安全性</span><span lang=EN-US
style='font-size:12.0pt'>. </span><span style='font-size:12.0pt;font-family:
宋体'>但</span><span lang=EN-US style='font-size:12.0pt'>RAID</span><span
style='font-size:12.0pt;font-family:宋体'>也有缺陷</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>这个机器的磁盘不可能无限的增加</span><span lang=EN-US style='font-size:12.0pt'>. </span><span
style='font-size:12.0pt;font-family:宋体'>单机容量受到磁盘架个数的限制</span><span lang=EN-US
style='font-size:12.0pt'>.</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;&nbsp; </span><span style='font-size:12.0pt;
font-family:宋体'>换一个思路</span><span lang=EN-US style='font-size:12.0pt'>, </span><span
style='font-size:12.0pt;font-family:宋体'>可以通过集群</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>将多台</span><span lang=EN-US style='font-size:12.0pt'>pc server</span><span
style='font-size:12.0pt;font-family:宋体'>联系到一起</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>使用软件逻辑而非硬件逻辑来进行数据的多磁盘备份</span><span lang=EN-US style='font-size:12.0pt'>.</span><span
style='font-size:12.0pt;font-family:宋体'>由此产生了</span><span lang=EN-US
style='font-size:12.0pt'>Quorum-based Journaling</span><span style='font-size:
12.0pt;font-family:宋体'>这个</span><span lang=EN-US style='font-size:12.0pt'>HA</span><span
style='font-size:12.0pt;font-family:宋体'>解决方案</span><span lang=EN-US
style='font-size:12.0pt'>. </span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;&nbsp; </span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:10.0pt;
font-family:宋体'><img width=534 height=507 src="hdfs.files/image005.gif"></span></p>

<p class=MsoNormal style='text-indent:24.0pt;text-autospace:none'><span
style='font-size:12.0pt;font-family:宋体'>概述一下</span><span lang=EN-US
style='font-size:12.0pt'>Quorum-based Journaling: </span><span
style='font-size:12.0pt;font-family:宋体'>多个后台进程的</span><span lang=EN-US
style='font-size:12.0pt'>Quorum commits</span><span style='font-size:12.0pt;
font-family:宋体'>，把这样的后台进程表示为</span><span lang=EN-US style='font-size:12.0pt'>JournalNodes</span><span
style='font-size:12.0pt;font-family:宋体'>。每一个</span><span lang=EN-US
style='font-size:12.0pt'>JournalNode</span><span style='font-size:12.0pt;
font-family:宋体'>暴露一个简单的</span><span lang=EN-US style='font-size:12.0pt'>RPC</span><span
style='font-size:12.0pt;font-family:宋体'>接口，允许</span><span lang=EN-US
style='font-size:12.0pt'>NameNode</span><span style='font-size:12.0pt;
font-family:宋体'>读</span><span style='font-size:12.0pt'> </span><span
style='font-size:12.0pt;font-family:宋体'>写</span><span lang=EN-US
style='font-size:12.0pt'>edit log</span><span style='font-size:12.0pt;
font-family:宋体'>，这个</span><span lang=EN-US style='font-size:12.0pt'>log</span><span
style='font-size:12.0pt;font-family:宋体'>是存在本地磁盘上。当</span><span lang=EN-US
style='font-size:12.0pt'>NameNode</span><span style='font-size:12.0pt;
font-family:宋体'>要写一个</span><span lang=EN-US style='font-size:12.0pt'>edit</span><span
style='font-size:12.0pt;font-family:宋体'>时，它发送这个</span><span lang=EN-US
style='font-size:12.0pt'>edit</span><span style='font-size:12.0pt;font-family:
宋体'>给集群中所有的</span><span lang=EN-US style='font-size:12.0pt'>JournalNodes</span><span
style='font-size:12.0pt;font-family:宋体'>，等待大多数节</span><span style='font-size:
12.0pt'> </span><span style='font-size:12.0pt;font-family:宋体'>点的回复。一旦大多数回复成功，这个</span><span
lang=EN-US style='font-size:12.0pt'>edit</span><span style='font-size:12.0pt;
font-family:宋体'>就被认为提交了。</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;&nbsp;&nbsp; Quorum-based</span><span
style='font-size:12.0pt;font-family:宋体'>相对于两阶段提交更轻量级</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>但延迟也比较厉害</span><span lang=EN-US style='font-size:12.0pt'>. QJM</span><span
style='font-size:12.0pt;font-family:宋体'>有相应的对策</span><span lang=EN-US
style='font-size:12.0pt'>,&nbsp; QJM</span><span style='font-size:12.0pt;
font-family:宋体'>中存储日志的</span><span lang=EN-US style='font-size:12.0pt'>JournalNode</span><span
style='font-size:12.0pt;font-family:宋体'>不会因为其中一台的延迟而影响整体的延迟，而且也不会因为</span><span
lang=EN-US style='font-size:12.0pt'>JournalNode</span><span style='font-size:
12.0pt;font-family:宋体'>的数量增多而影响性能（因为</span><span lang=EN-US style='font-size:
12.0pt'>NN</span><span style='font-size:12.0pt;font-family:宋体'>向</span><span
lang=EN-US style='font-size:12.0pt'>JournalNode</span><span style='font-size:
12.0pt;font-family:宋体'>发送日志是并行的）</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt;text-autospace:
none'><b><span lang=EN-US style='font-size:15.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><b><span style='font-size:15.0pt;font-family:宋体'>机制</span></b></p>

<p class=MsoNormal style='margin-left:18.0pt;text-autospace:none'><span
style='font-size:12.0pt;font-family:宋体'>在看了些解决方案之后</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>再看一下各个</span><span lang=EN-US style='font-size:12.0pt'>HA</span><span
style='font-size:12.0pt;font-family:宋体'>解决方案之后的实现机制</span></p>

<p class=MsoNormal style='margin-left:18.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;&nbsp; I. </span><span style='font-size:12.0pt;
font-family:宋体'>表决</span><span lang=EN-US style='font-size:12.0pt'>: </span><span
style='font-size:12.0pt;font-family:宋体'>相同的组件输入相同的输入</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>他们的计算后的简单输出发送给表决者</span><span lang=EN-US style='font-size:12.0pt'>. </span><span
style='font-size:12.0pt;font-family:宋体'>如果表决者检测到异常行为</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>就终止这个组件的行为</span><span lang=EN-US style='font-size:12.0pt'>. </span><span
style='font-size:12.0pt;font-family:宋体'>表决算法可以是</span><span lang=EN-US
style='font-size:12.0pt'>”</span><span style='font-size:12.0pt;font-family:
宋体'>多数规则</span><span lang=EN-US style='font-size:12.0pt'>”</span><span
style='font-size:12.0pt;font-family:宋体'>等算法</span><span lang=EN-US
style='font-size:12.0pt'>. </span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp; </span><span style='font-size:12.0pt;
font-family:宋体'>也叫协调器</span><span lang=EN-US style='font-size:12.0pt'>
coordination, eg. </span><span style='font-size:12.0pt;font-family:宋体'>两阶段的</span><span
lang=EN-US style='font-size:12.0pt'>deterministic coordinator, PAXOS/Qurumn
coordinator .&nbsp;&nbsp; </span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp; II. </span><span style='font-size:12.0pt;
font-family:宋体'>主动冗余</span><span lang=EN-US style='font-size:12.0pt'>:</span><span
style='font-size:12.0pt;font-family:宋体'>　系统中的组件以并行的方式接受请求</span><span
lang=EN-US style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;
font-family:宋体'>仅仅使用一个组件的响应</span><span lang=EN-US style='font-size:12.0pt'>.</span><span
style='font-size:12.0pt;font-family:宋体'>　异常发生时</span><span lang=EN-US
style='font-size:12.0pt'>,</span><span style='font-size:12.0pt;font-family:
宋体'>　系统的停机时间是通常是秒级</span><span lang=EN-US style='font-size:12.0pt'>,</span><span
style='font-size:12.0pt;font-family:宋体'>　因为备份组件的状态是最新的</span><span lang=EN-US
style='font-size:12.0pt'>,</span><span style='font-size:12.0pt;font-family:
宋体'>　如果是自动切换</span><span lang=EN-US style='font-size:12.0pt'>,</span><span
style='font-size:12.0pt;font-family:宋体'>　停机时间会缩的更短</span><span lang=EN-US
style='font-size:12.0pt'>.</span></p>

<p class=MsoNormal style='margin-top:8.7pt;margin-right:0cm;margin-bottom:8.7pt;
margin-left:0cm;text-autospace:none'><span lang=EN-US style='font-size:12.0pt'>&nbsp;
Eg. Hadoop 2.0 HA</span><span style='font-size:12.0pt;font-family:宋体'>中</span><span
lang=EN-US style='font-size:12.0pt'>DN</span><span style='font-size:12.0pt;
font-family:宋体'>同时向</span><span lang=EN-US style='font-size:12.0pt'>NN Active</span><span
style='font-size:12.0pt;font-family:宋体'>和</span><span lang=EN-US
style='font-size:12.0pt'>NN Standby</span><span style='font-size:12.0pt;
font-family:宋体'>发送</span><span lang=EN-US style='font-size:12.0pt'>block
report.</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp; </span><span style='font-size:12.0pt;
font-family:宋体'>扩展</span><span lang=EN-US style='font-size:12.0pt'>: mapreduce</span><span
style='font-size:12.0pt;font-family:宋体'>的推测执行</span><span lang=EN-US
style='font-size:12.0pt'> (</span><span lang=EN-US>speculative execution</span><span
lang=EN-US style='font-size:12.0pt'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp; III. </span><span style='font-size:12.0pt;
font-family:宋体'>被动冗余</span><span lang=EN-US style='font-size:12.0pt'>:</span><span
style='font-size:12.0pt;font-family:宋体'>　系统中的一个组件接受请求</span><span lang=EN-US
style='font-size:12.0pt'>,</span><span style='font-size:12.0pt;font-family:
宋体'>　然后通知备用组件进行状态的更新</span><span lang=EN-US style='font-size:12.0pt'>.</span><span
style='font-size:12.0pt;font-family:宋体'>　何时接管主组件的工作可以由备用组件或其它组件决定</span><span
lang=EN-US style='font-size:12.0pt'>.</span><span style='font-size:12.0pt;
font-family:宋体'>　主组件会发出状态同步的命令</span><span lang=EN-US style='font-size:12.0pt'>.</span><span
style='font-size:12.0pt;font-family:宋体'>　</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;&nbsp; Eg. AvatarNode </span><span
style='font-size:12.0pt;font-family:宋体'>和</span><span lang=EN-US
style='font-size:12.0pt'> Hadoop 2.0 HA</span><span style='font-size:12.0pt;
font-family:宋体'>中</span><span lang=EN-US style='font-size:12.0pt'>, NN Active </span><span
style='font-size:12.0pt;font-family:宋体'>同步</span><span lang=EN-US
style='font-size:12.0pt'>EditLog</span><span style='font-size:12.0pt;
font-family:宋体'>到</span><span lang=EN-US style='font-size:12.0pt'>NN Standby</span><span
style='font-size:12.0pt;font-family:宋体'>中</span><span lang=EN-US
style='font-size:12.0pt'>.</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;&nbsp; </span><span style='font-size:12.0pt;
font-family:宋体'>扩展</span><span lang=EN-US style='font-size:12.0pt'>:</span><span
style='font-size:12.0pt;font-family:宋体'>　</span><span lang=EN-US
style='font-size:12.0pt'>Datanode</span><span style='font-size:12.0pt;
font-family:宋体'>一备三</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
font-family:宋体'>　　　</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp; IV. Checkpoint</span><span style='font-size:
12.0pt;font-family:宋体'>还原点</span><span lang=EN-US style='font-size:12.0pt'>: </span><span
style='font-size:12.0pt;font-family:宋体'>可以看成是对组件健康状态的一次快照</span><span
lang=EN-US style='font-size:12.0pt'>.</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp; Eg. SNN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp; </span><span style='font-size:12.0pt;
font-family:宋体'>扩展</span><span lang=EN-US style='font-size:12.0pt'>: Oracle
checkpoint, VM snapshot</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp; V. </span><span style='font-size:12.0pt;
font-family:宋体'>状态同步</span><span lang=EN-US style='font-size:12.0pt'>(</span><span
style='font-size:12.0pt;font-family:宋体'>状态外移</span><span lang=EN-US
style='font-size:12.0pt'>): </span><span style='font-size:12.0pt;font-family:
宋体'>备用组件在提供服务之前需要和主组件的状态一致</span><span lang=EN-US style='font-size:12.0pt'>. </span><span
style='font-size:12.0pt;font-family:宋体'>恢复组件重新提供服务前要同步到失效之前正常的状态</span><span
lang=EN-US style='font-size:12.0pt'>.</span><span style='font-size:12.0pt;
font-family:宋体'>　</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp; Eg.&nbsp; Hadoop 2.0 HA</span><span
style='font-size:12.0pt;font-family:宋体'>中</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>通过被动冗余的</span><span lang=EN-US style='font-size:12.0pt'>editlog</span><span
style='font-size:12.0pt;font-family:宋体'>和主动冗余的</span><span lang=EN-US
style='font-size:12.0pt'>block report, NN Standby</span><span style='font-size:
12.0pt;font-family:宋体'>回放</span><span lang=EN-US style='font-size:12.0pt'>editlog</span><span
style='font-size:12.0pt;font-family:宋体'>与</span><span lang=EN-US
style='font-size:12.0pt'>fsimage</span><span style='font-size:12.0pt;
font-family:宋体'>合并来实时和</span><span lang=EN-US style='font-size:12.0pt'>NN
Active</span><span style='font-size:12.0pt;font-family:宋体'>的状态保持一致</span><span
lang=EN-US style='font-size:12.0pt'>.</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp; </span><span style='font-size:12.0pt;
font-family:宋体'>扩展</span><span lang=EN-US style='font-size:12.0pt'>:&nbsp;
Mysql slave </span><span style='font-size:12.0pt;font-family:宋体'>的</span><span
lang=EN-US style='font-size:12.0pt'>binlog</span><span style='font-size:12.0pt;
font-family:宋体'>同步</span><span lang=EN-US style='font-size:12.0pt'>, Redis
slave RDD </span><span style='font-size:12.0pt;font-family:宋体'>文件同步</span><span
lang=EN-US style='font-size:12.0pt'> </span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp; VI. </span><span style='font-size:12.0pt;
font-family:宋体'>命令</span><span lang=EN-US style='font-size:12.0pt'>/</span><span
style='font-size:12.0pt;font-family:宋体'>响应</span><span lang=EN-US
style='font-size:12.0pt'>(</span><span style='font-size:12.0pt;font-family:
宋体'>主动</span><span lang=EN-US style='font-size:12.0pt'>) :</span><span
style='font-size:12.0pt;font-family:宋体'>　一个组件发出一个命令</span><span lang=EN-US
style='font-size:12.0pt'>,</span><span style='font-size:12.0pt;font-family:
宋体'>　并希望在预定义的时间内收到一个来自对方组件的响应</span><span lang=EN-US style='font-size:12.0pt'>.</span></p>

<p class=MsoNormal style='text-indent:12.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt'>Eg,&nbsp; FailoverController</span><span
style='font-size:12.0pt;font-family:宋体'>发送命令给</span><span lang=EN-US
style='font-size:12.0pt'>NN active, </span><span style='font-size:12.0pt;
font-family:宋体'>如果</span><span lang=EN-US style='font-size:12.0pt'>NN active</span><span
style='font-size:12.0pt;font-family:宋体'>宕机</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>就不能返回相应</span><span lang=EN-US style='font-size:12.0pt'>.</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
font-family:宋体'>　</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
font-family:宋体'>　</span><span lang=EN-US style='font-size:12.0pt'>VII. </span><span
style='font-size:12.0pt;font-family:宋体'>心跳</span><span lang=EN-US
style='font-size:12.0pt'>:</span><span style='font-size:12.0pt;font-family:
宋体'>　一个组件定期发出一个消息</span><span lang=EN-US style='font-size:12.0pt'>(</span><span
style='font-size:12.0pt;font-family:宋体'>心跳</span><span lang=EN-US
style='font-size:12.0pt'>),</span><span style='font-size:12.0pt;font-family:
宋体'>　另一个组件收听这个消息</span><span lang=EN-US style='font-size:12.0pt'>,</span><span
style='font-size:12.0pt;font-family:宋体'>　知道组件是否健康</span><span lang=EN-US
style='font-size:12.0pt'>.</span><span style='font-size:12.0pt;font-family:
宋体'>　</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp; Eg: FailoverController</span><span
style='font-size:12.0pt;font-family:宋体'>通过检测到</span><span lang=EN-US
style='font-size:12.0pt'>NN active</span><span style='font-size:12.0pt;
font-family:宋体'>不健康</span><span lang=EN-US style='font-size:12.0pt'>,&nbsp; </span><span
style='font-size:12.0pt;font-family:宋体'>会停止发心跳给</span><span lang=EN-US
style='font-size:12.0pt'>zookeeper,&nbsp; zookeeper</span><span
style='font-size:12.0pt;font-family:宋体'>知道</span><span lang=EN-US
style='font-size:12.0pt'>NN acive</span><span style='font-size:12.0pt;
font-family:宋体'>已宕机</span><span lang=EN-US style='font-size:12.0pt'>, </span><span
style='font-size:12.0pt;font-family:宋体'>会做领导者的选举</span><span lang=EN-US
style='font-size:12.0pt'>.</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp; VII. </span><span style='font-size:12.0pt;
font-family:宋体'>影子服务</span><span lang=EN-US style='font-size:12.0pt'>: </span><span
style='font-size:12.0pt;font-family:宋体'>备用组件和主组件的状态一致</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>但主组件不宕机的情况下不对外提供服务</span><span lang=EN-US style='font-size:12.0pt'>.</span></p>

<p class=MsoNormal style='margin-top:8.7pt;margin-right:0cm;margin-bottom:8.7pt;
margin-left:0cm;text-autospace:none'><span lang=EN-US style='font-size:12.0pt'>&nbsp;
Eg. AvatarNode </span><span style='font-size:12.0pt;font-family:宋体'>和</span><span
lang=EN-US style='font-size:12.0pt'> Hadoop 2.0 HA</span><span
style='font-size:12.0pt;font-family:宋体'>中的</span><span lang=EN-US
style='font-size:12.0pt'>standby</span></p>

<p class=MsoNormal style='margin-top:8.7pt;margin-right:0cm;margin-bottom:8.7pt;
margin-left:0cm;text-autospace:none'><span lang=EN-US style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:12.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt;font-family:"Arial","sans-serif"'>VIII. </span><span
style='font-size:12.0pt;font-family:宋体'>冷备份</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Arial","sans-serif"'>: standby</span><span
style='font-size:12.0pt;font-family:宋体'>没有运行</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Arial","sans-serif"'>, standby</span><span
style='font-size:12.0pt;font-family:宋体'>能通过读</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Arial","sans-serif"'>fsimage</span><span
style='font-size:12.0pt;font-family:宋体'>和</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Arial","sans-serif"'>editlog, </span><span
style='font-size:12.0pt;font-family:宋体'>等待</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Arial","sans-serif"'>block report</span><span
style='font-size:12.0pt;font-family:宋体'>来建立需要的状态</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Arial","sans-serif"'>.</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:12.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt;font-family:"Arial","sans-serif"'>VIIII. </span><span
style='font-size:12.0pt;font-family:宋体'>温备份</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Arial","sans-serif"'>: standby</span><span
style='font-size:12.0pt;font-family:宋体'>装载了</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Arial","sans-serif"'>fsimage</span><span
style='font-size:12.0pt;font-family:宋体'>和</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Arial","sans-serif"'>editlog, </span><span
style='font-size:12.0pt;font-family:宋体'>但没有最近的</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Arial","sans-serif"'>block report. </span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:12.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt;font-family:"Arial","sans-serif"'>X. </span><span
style='font-size:12.0pt;font-family:宋体'>热备份</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Arial","sans-serif"'>: standby</span><span
style='font-size:12.0pt;font-family:宋体'>有足够的驻内存的状态来取代</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Arial","sans-serif"'>active.</span></p>

<p class=MsoNormal style='margin-top:8.7pt;margin-right:0cm;margin-bottom:8.7pt;
margin-left:0cm;text-autospace:none'><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal style='margin-top:8.7pt;margin-right:0cm;margin-bottom:8.7pt;
margin-left:0cm;text-autospace:none'><b><span lang=EN-US style='font-size:15.0pt'>3.&nbsp;
</span></b><b><span style='font-size:15.0pt;font-family:宋体'>权衡</span></b></p>

<p class=MsoNormal style='text-indent:12.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt;font-family:"Cambria","serif"'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:12.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt;font-family:"Cambria","serif"'>Backup node</span><span
style='font-size:12.0pt;font-family:宋体'>异步写有丢失小部分数据的可能</span><span lang=EN-US
style='font-size:12.0pt'>,</span><span style='font-size:12.0pt;font-family:
宋体'>但吞吐量好</span><span lang=EN-US style='font-size:12.0pt'>,</span><span
style='font-size:12.0pt;font-family:宋体'>　延迟低</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>能达到最终一致性</span><span lang=EN-US style='font-size:12.0pt'>. </span><span
lang=EN-US style='font-size:12.0pt;font-family:"Cambria","serif"'>BackupNode </span><span
style='font-size:12.0pt;font-family:宋体'>在宕机时</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>, </span><span
style='font-size:12.0pt;font-family:宋体'>还是需要把状态的远端外部存储拿回</span><span
lang=EN-US style='font-size:12.0pt;font-family:"Cambria","serif"'>, </span><span
style='font-size:12.0pt;font-family:宋体'>这又成了共享存储</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>.</span></p>

<p class=MsoNormal style='text-indent:12.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt;font-family:"Cambria","serif"'>&nbsp; </span></p>

<p class=MsoNormal style='margin-top:7.05pt;margin-right:0cm;margin-bottom:
7.05pt;margin-left:0cm;text-indent:12.0pt;text-autospace:none'><span
style='font-size:12.0pt;font-family:宋体'>如果对数据完整性要求比较高</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>, </span><span
style='font-size:12.0pt;font-family:宋体'>可以使用两阶段提交和</span><span lang=EN-US
style='font-size:12.0pt'>PAXOS. </span><span style='font-size:12.0pt;
font-family:宋体'>两阶段提交在没有</span><span lang=EN-US style='font-size:12.0pt'>timeout</span><span
style='font-size:12.0pt;font-family:宋体'>的机制时</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>强依赖备用组件</span><span lang=EN-US style='font-size:12.0pt'>.&nbsp; </span><span
style='font-size:12.0pt;font-family:宋体'>实现相对重量级</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>由于要同步提交或者回滚</span><span lang=EN-US style='font-size:12.0pt'>, </span><span
style='font-size:12.0pt;font-family:宋体'>所以延迟高</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>并且吞吐量低</span><span lang=EN-US style='font-size:12.0pt'>. </span></p>

<p class=MsoNormal style='margin-top:7.05pt;margin-right:0cm;margin-bottom:
7.05pt;margin-left:0cm;text-indent:18.0pt;text-autospace:none'><span
lang=EN-US style='font-size:12.0pt'>Quorum</span><span style='font-size:12.0pt;
font-family:宋体'>尝试复制多份数据</span><span lang=EN-US style='font-size:12.0pt'>,</span><span
style='font-size:12.0pt;font-family:宋体'>　只要有过半的节点成功</span><span lang=EN-US
style='font-size:12.0pt'>,</span><span style='font-size:12.0pt;font-family:
宋体'>　即整个备份过程成功</span><span lang=EN-US style='font-size:12.0pt'>. PAXOS</span><span
style='font-size:12.0pt;font-family:宋体'>的多个变体通过合理的放弃一些性能与一致性，集群可以容忍几乎多达</span><span
lang=EN-US style='font-size:12.0pt'>n/2</span><span style='font-size:12.0pt;
font-family:宋体'>个数的节点失效。这种折中在两阶段提交与</span><span lang=EN-US style='font-size:
12.0pt'> PAXOS </span><span style='font-size:12.0pt;font-family:宋体'>协议的区别里体现得很明显。所以社区并未出现基于两阶段提交的</span><span
lang=EN-US style='font-size:12.0pt'>HA</span><span style='font-size:12.0pt;
font-family:宋体'>方案</span><span lang=EN-US style='font-size:12.0pt'>, </span><span
style='font-size:12.0pt;font-family:宋体'>而是出现了</span><span lang=EN-US
style='font-size:12.0pt'>Quorum-based Journaling in CDH4.1</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>&nbsp;&nbsp; </span><span
style='font-size:12.0pt;font-family:宋体'>在</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>failover</span><span
style='font-size:12.0pt;font-family:宋体'>后的客户端重定向</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>, </span><span
style='font-size:12.0pt;font-family:宋体'>生产中的解决方案</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>, </span><span
style='font-size:12.0pt;font-family:宋体'>往往通过</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>virtual IP address</span><span
style='font-size:12.0pt;font-family:宋体'>提供</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>namenode</span><span
style='font-size:12.0pt;font-family:宋体'>服务</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>,&nbsp; standby</span><span
style='font-size:12.0pt;font-family:宋体'>接管为</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>acitive</span><span
style='font-size:12.0pt;font-family:宋体'>后会也使用这个虚拟</span><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>ip</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>&nbsp;</span></p>

<p class=MsoNormal style='margin-top:7.05pt;margin-right:0cm;margin-bottom:
7.05pt;margin-left:0cm;text-autospace:none'><span lang=EN-US style='font-size:
12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;&nbsp; </span><span style='font-size:12.0pt;
font-family:宋体'>下图从几个维度给出各种HA解决方案的比较</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt;font-family:"Cambria","serif"'>&nbsp;</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=658
 style='width:493.2pt;margin-left:-5.4pt;border-collapse:collapse'>
 <tr style='height:22.15pt'>
  <td width=92 valign=top style='width:69.05pt;border:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt'>&nbsp;</span></p>
  </td>
  <td width=83 valign=top style='width:62.0pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>备份方式</span></p>
  </td>
  <td width=94 valign=top style='width:70.75pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>协议</span></p>
  </td>
  <td width=80 valign=top style='width:60.35pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>是否丢数据</span></p>
  </td>
  <td width=90 valign=top style='width:67.25pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>可用性</span></p>
  </td>
  <td width=72 valign=top style='width:54.0pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>切换时间</span></p>
  </td>
  <td width=131 valign=top style='width:98.0pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>机制</span></p>
  </td>
  <td width=16 valign=top style='width:11.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt;font-family:"Cambria","serif"'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='height:22.15pt'>
  <td width=92 valign=top style='width:69.05pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt;font-family:"Cambria","serif"'>Backup node</span></p>
  </td>
  <td width=83 valign=top style='width:62.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>温备</span></p>
  </td>
  <td width=94 valign=top style='width:70.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt;font-family:"Cambria","serif"'>Master-Slave</span></p>
  </td>
  <td width=80 valign=top style='width:60.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>丢数据</span></p>
  </td>
  <td width=90 valign=top style='width:67.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>基本可用</span></p>
  </td>
  <td width=72 valign=top style='width:54.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>分钟</span><span lang=EN-US style='font-size:12.0pt'>~</span><span
  style='font-size:12.0pt;font-family:宋体'>小时级</span></p>
  </td>
  <td width=131 valign=top style='width:98.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt'>Checkpoint + EditLog</span><span style='font-size:
  12.0pt;font-family:宋体'>被动冗余</span></p>
  </td>
  <td width=16 valign=top style='width:11.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt;font-family:"Cambria","serif"'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='height:22.15pt'>
  <td width=92 valign=top style='width:69.05pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt;font-family:"Cambria","serif"'>AvatarNode</span></p>
  </td>
  <td width=83 valign=top style='width:62.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>热备</span></p>
  </td>
  <td width=94 valign=top style='width:70.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>数据安全的</span><span lang=EN-US style='font-size:12.0pt;
  font-family:"Cambria","serif"'>Master-Slave</span></p>
  </td>
  <td width=80 valign=top style='width:60.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>不会丢数据</span></p>
  </td>
  <td width=90 valign=top style='width:67.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>高可用</span><span lang=EN-US style='font-size:12.0pt;
  font-family:"Cambria","serif"'>/</span><span style='font-size:12.0pt;
  font-family:宋体'>依赖外部可用性</span></p>
  </td>
  <td width=72 valign=top style='width:54.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>秒</span><span lang=EN-US style='font-size:12.0pt'>~</span><span
  style='font-size:12.0pt;font-family:宋体'>分钟级别</span></p>
  </td>
  <td width=131 valign=top style='width:98.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt'>blockmap </span><span style='font-size:12.0pt;
  font-family:宋体'>主动冗余</span><span lang=EN-US style='font-size:12.0pt'> +&nbsp;
  EditLog</span><span style='font-size:12.0pt;font-family:宋体'>被动冗余</span><span
  lang=EN-US style='font-size:12.0pt'> + </span><span style='font-size:12.0pt;
  font-family:宋体'>影子服务</span></p>
  </td>
  <td width=16 valign=top style='width:11.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt;font-family:"Cambria","serif"'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='height:22.15pt'>
  <td width=92 valign=top style='width:69.05pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt;font-family:"Cambria","serif"'>HDFS HA 2.0(NFS)</span></p>
  </td>
  <td width=83 valign=top style='width:62.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>热备</span></p>
  </td>
  <td width=94 valign=top style='width:70.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>数据安全的</span><span lang=EN-US style='font-size:12.0pt;
  font-family:"Cambria","serif"'>Master-Slave</span></p>
  </td>
  <td width=80 valign=top style='width:60.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>不会丢数据</span></p>
  </td>
  <td width=90 valign=top style='width:67.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>依赖外部可用性</span><span lang=EN-US style='font-size:12.0pt;
  font-family:"Cambria","serif"'>/</span><span style='font-size:12.0pt;
  font-family:宋体'>依赖外部可用性</span></p>
  </td>
  <td width=72 valign=top style='width:54.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt'>5-20s</span></p>
  </td>
  <td width=131 valign=top style='width:98.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt'>blockmap </span><span style='font-size:12.0pt;
  font-family:宋体'>主动冗余</span><span lang=EN-US style='font-size:12.0pt'> +&nbsp;
  EditLog</span><span style='font-size:12.0pt;font-family:宋体'>被动冗余</span><span
  lang=EN-US style='font-size:12.0pt'> + </span><span style='font-size:12.0pt;
  font-family:宋体'>影子服务</span></p>
  </td>
  <td width=16 valign=top style='width:11.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt;font-family:"Cambria","serif"'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='height:22.15pt'>
  <td width=92 valign=top style='width:69.05pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt'>QJM/Qurom Journal Manager</span></p>
  </td>
  <td width=83 valign=top style='width:62.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>热备</span></p>
  </td>
  <td width=94 valign=top style='width:70.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt;font-family:"Cambria","serif"'>PAXOS</span></p>
  </td>
  <td width=80 valign=top style='width:60.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>不会丢数据</span></p>
  </td>
  <td width=90 valign=top style='width:67.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>高可用</span></p>
  </td>
  <td width=72 valign=top style='width:54.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
  font-family:宋体'>小于</span><span lang=EN-US style='font-size:12.0pt;font-family:
  "Cambria","serif"'>1</span><span style='font-size:12.0pt;font-family:宋体'>分钟</span></p>
  </td>
  <td width=131 valign=top style='width:98.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt'>EditLog</span><span style='font-size:12.0pt;
  font-family:宋体'>被动冗余</span><span lang=EN-US style='font-size:12.0pt'>(Quorum-based)</span></p>
  </td>
  <td width=16 valign=top style='width:11.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.15pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt;font-family:"Cambria","serif"'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='height:2.55pt'>
  <td width=92 valign=top style='width:69.05pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:2.55pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt'>&nbsp;</span></p>
  </td>
  <td width=83 valign=top style='width:62.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:2.55pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt'>&nbsp;</span></p>
  </td>
  <td width=94 valign=top style='width:70.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:2.55pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt'>&nbsp;</span></p>
  </td>
  <td width=80 valign=top style='width:60.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:2.55pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt'>&nbsp;</span></p>
  </td>
  <td width=90 valign=top style='width:67.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:2.55pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt'>&nbsp;</span></p>
  </td>
  <td width=72 valign=top style='width:54.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:2.55pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt'>&nbsp;</span></p>
  </td>
  <td width=131 valign=top style='width:98.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:2.55pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt'>&nbsp;</span></p>
  </td>
  <td width=16 valign=top style='width:11.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:2.55pt'>
  <p class=MsoNormal style='text-autospace:none'><span lang=EN-US
  style='font-size:12.0pt'>&nbsp;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>CAP</span><span style='font-size:12.0pt;font-family:
宋体'>理论是一个相对论</span><span lang=EN-US style='font-size:12.0pt'>,&nbsp; </span><span
style='font-size:12.0pt;font-family:宋体'>说明在分布式系统中提供的是相对的可用性</span><span
lang=EN-US style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;
font-family:宋体'>一致性</span><span lang=EN-US style='font-size:12.0pt'>.&nbsp;
Hadoop namenode </span><span style='font-size:12.0pt;font-family:宋体'>的可用性也是相对的可用</span><span
lang=EN-US style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;
font-family:宋体'>以下是一些小结</span><span lang=EN-US style='font-size:12.0pt'>:</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='margin-top:8.7pt;margin-right:0cm;margin-bottom:8.7pt;
margin-left:0cm;text-autospace:none'><span lang=EN-US style='font-size:12.0pt'>Backup
Node:&nbsp; </span><span style='font-size:12.0pt;font-family:宋体'>延迟比较低</span><span
lang=EN-US style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;
font-family:宋体'>吞吐量比较高</span><span lang=EN-US style='font-size:12.0pt'>, </span><span
style='font-size:12.0pt;font-family:宋体'>并能容忍少量的数据丢失</span><span lang=EN-US
style='font-size:12.0pt'>.&nbsp;&nbsp;&nbsp; </span></p>

<p class=MsoNormal style='margin-top:8.7pt;margin-right:0cm;margin-bottom:8.7pt;
margin-left:0cm;text-autospace:none'><span lang=EN-US style='font-size:12.0pt'>Hadoop
HA 2.0: </span><span style='font-size:12.0pt;font-family:宋体'>要求数据不能丢失</span><span
lang=EN-US style='font-size:12.0pt'>.&nbsp; </span><span style='font-size:12.0pt;
font-family:宋体'>即可以使用</span><span lang=EN-US style='font-size:12.0pt'>NFS, </span><span
style='font-size:12.0pt;font-family:宋体'>也可以使用</span><span lang=EN-US
style='font-size:12.0pt'>Bookkeeper, </span><span style='font-size:12.0pt;
font-family:宋体'>既可以手动切换</span><span lang=EN-US style='font-size:12.0pt'>,</span><span
style='font-size:12.0pt;font-family:宋体'>也可以自动切换</span><span lang=EN-US
style='font-size:12.0pt'>Standby NN. </span><span style='font-size:12.0pt;
font-family:宋体'>切换时间短</span><span lang=EN-US style='font-size:12.0pt'>.&nbsp; </span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>Quorum-based journaling: </span><span
style='font-size:12.0pt;font-family:宋体'>要求数据不能丢失</span><span lang=EN-US
style='font-size:12.0pt'>, </span><span style='font-size:12.0pt;font-family:
宋体'>并且对延迟要求不高的情况</span><span lang=EN-US style='font-size:12.0pt'>, </span><span
style='font-size:12.0pt;font-family:宋体'>也不希望使用昂贵的外部存储</span><span lang=EN-US
style='font-size:12.0pt'>.&nbsp; </span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span style='font-size:12.0pt;
font-family:宋体'>参考:</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>https://issues.apache.org/jira/browse/HDFS-1623&nbsp;&nbsp;
( High Availability Framework for HDFS NN) </span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>http://www.docin.com/p-532877866.html&nbsp;&nbsp;
(&nbsp; </span><span style='font-size:12.0pt;font-family:宋体'>海量存储系列</span><span
lang=EN-US style='font-size:12.0pt'>1-15 )</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>http://www.infoq.com/cn/articles/hadoop-2-0-namenode-ha-federation-practice-zh
(&nbsp; Hadoop 2.0 NameNode HA</span><span style='font-size:12.0pt;font-family:
宋体'>和</span><span lang=EN-US style='font-size:12.0pt'>Federation</span><span
style='font-size:12.0pt;font-family:宋体'>实践</span><span lang=EN-US
style='font-size:12.0pt'> )</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>http://yanbohappy.sinaapp.com/?p=205 (</span><span
style='font-size:12.0pt;font-family:宋体'>基于</span><span lang=EN-US
style='font-size:12.0pt'>QJM/Qurom Journal Manager/Paxos</span><span
style='font-size:12.0pt;font-family:宋体'>的</span><span lang=EN-US
style='font-size:12.0pt'>HDFS HA</span><span style='font-size:12.0pt;
font-family:宋体'>原理及代码分析</span><span lang=EN-US style='font-size:12.0pt'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>http://www.tuicool.com/articles/EZnE7v (Quorum-based
Journaling in CDH4.1)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>http://www.infoq.com/cn/news/2012/08/facebook-avatarnode&nbsp;
(Facebook</span><span style='font-size:12.0pt;font-family:宋体'>如何使用</span><span
lang=EN-US style='font-size:12.0pt'>Avartarnode</span><span style='font-size:
12.0pt;font-family:宋体'>提升</span><span lang=EN-US style='font-size:12.0pt'>HDFS</span><span
style='font-size:12.0pt;font-family:宋体'>可靠性</span><span lang=EN-US
style='font-size:12.0pt'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>http://www.itinit.net/thread-2468-1-1.html&nbsp;&nbsp;
(hadoop HA</span><span style='font-size:12.0pt;font-family:宋体'>使用</span><span
lang=EN-US style='font-size:12.0pt'>Quorum Journal</span><span
style='font-size:12.0pt;font-family:宋体'>的设计</span><span lang=EN-US
style='font-size:12.0pt'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>http://blog.nosqlfan.com/html/4139.html&nbsp; (NoSQL</span><span
style='font-size:12.0pt;font-family:宋体'>数据库的分布式算法</span><span lang=EN-US
style='font-size:12.0pt'>)</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-autospace:none'><span lang=EN-US
style='font-size:12.0pt'>&nbsp;</span></p>

</div>

</body>

</html>
